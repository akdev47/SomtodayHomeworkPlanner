<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson Details</title>
    <!-- FONTS -->
    <link rel="stylesheet" href="style/specificlesson.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:ital,wght@0,100..700;1,100..700&display=swap" rel="stylesheet">
</head>
<body class="josefin-sans-regular">
<div class="container">
    <div class="side-bar red">
        <div class="container-1">
            <img src="./res/WhatsApp_Image_2024-05-24_at_12.26.37-removebg-preview.png" alt="Somtoday logo" class="logo">
            <p class="logo-text">somtoday</p>
        </div>
        <div class="container-2">
            <ul class="navigations">
                <li class="nav-item">
                    <a href="dashboard.html" class="nav-link">
                        <i class="nav-item-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px">
                                <path d="M240-200h120v-240h240v240h120v-360L480-740 240-560v360Zm-80 80v-480l320-240 320 240v480H520v-240h-80v240H160Zm320-350Z" />
                            </svg>
                        </i>
                        <p class="nav-item-text">Home</p>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="assignments-teacher.html" class="nav-link">
                        <i class="nav-item-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px">
                                <path d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h168q13-36 43.5-58t68.5-22q38 0 68.5 22t43.5 58h168q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm80-80h280v-80H280v80Zm0-160h400v-80H280v80Zm0-160h400v-80H280v80Zm200-190q13 0 21.5-8.5T510-820q0-13-8.5-21.5T480-850q-13 0-21.5 8.5T450-820q0 13 8.5 21.5T480-790ZM200-200v-560 560Z" />
                            </svg>
                        </i>
                        <p class="nav-item-text">Assignments</p>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#notifications" class="nav-link">
                        <i class="nav-item-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px">
                                <path d="M160-200v-80h80v-280q0-83 50-147.5T420-792v-28q0-25 17.5-42.5T480-880q25 0 42.5 17.5T540-820v28q80 20 130 84.5T720-560v280h80v80H160Zm320-300Zm0 420q-33 0-56.5-23.5T400-160h160q0 33-23.5 56.5T480-80ZM320-280h320v-280q0-66-47-113t-113-47q-66 0-113 47t-47 113v280Z" />
                            </svg>
                        </i>
                        <p class="nav-item-text">Notifications</p>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="classes.html" class="nav-link">
                        <i class="nav-item-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px">
                                <path d="M560-564v-68q33-14 67.5-21t72.5-7q26 0 51 4t49 10v64q-24-9-48.5-13.5T700-600q-38 0-73 9.5T560-564Zm0 220v-68q33-14 67.5-21t72.5-7q26 0 51 4t49 10v64q-24-9-48.5-13.5T700-380q-38 0-73 9t-67 27Zm0-110v-68q33-14 67.5-21t72.5-7q26 0 51 4t49 10v64q-24-9-48.5-13.5T700-490q-38 0-73 9.5T560-454ZM260-320q47 0 91.5 10.5T440-278v-394q-41-24-87-36t-93-12q-36 0-71.5 7T120-692v396q35-12 69.5-18t70.5-6Zm260 42q44-21 88.5-31.5T700-320q36 0 70.5 6t69.5 18v-396q-33-14-68.5-21t-71.5-7q-47 0-93 12t-87 36v394Zm-40 118q-48-38-104-59t-116-21q-42 0-82.5 11T100-198q-21 11-40.5-1T40-234v-482q0-11 5.5-21T62-752q46-24 96-36t102-12q58 0 113.5 15T480-740q51-30 106.5-45T700-800q52 0 102 12t96 36q11 5 16.5 15t5.5 21v482q0 23-19.5 35t-40.5 1q-37-20-77.5-31T700-240q-60 0-116 21t-104 59ZM280-494Z" />
                            </svg>
                        </i>
                        <p class="nav-item-text">Classes</p>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="lessons.html" class="nav-link">
                        <i class="nav-item-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px">
                                <path d="M480-120 200-272v-240L40-600l440-240 440 240v320h-80v-276l-80 44v240L480-120Zm0-332 274-148-274-148-274 148 274 148Zm0 241 200-108v-151L480-360 280-470v151l200 108Zm0-241Zm0 90Zm0 0Z" />
                            </svg>
                        </i>
                        <p class="nav-item-text">Lessons</p>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#profile" class="nav-link">
                        <i class="nav-item-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px">
                                <path d="M480-480q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM160-160v-112q0-34 17.5-62.5T224-378q62-31 126-46.5T480-440q66 0 130 15.5T736-378q29 15 46.5 43.5T800-272v112H160Zm80-80h480v-32q0-11-5.5-20T700-306q-54-27-109-40.5T480-360q-56 0-111 13.5T260-306q-9 5-14.5 14t-5.5 20v32Zm240-320q33 0 56.5-23.5T560-640q0-33-23.5-56.5T480-720q-33 0-56.5 23.5T400-640q0 33 23.5 56.5T480-560Zm0-80Zm0 400Z" />
                            </svg>
                        </i>
                        <p class="nav-item-text">Profile</p>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#people" class="nav-link">
                        <i class="nav-item-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px">
                                <path d="M40-160v-112q0-34 17.5-62.5T104-378q62-31 126-46.5T360-440q66 0 130 15.5T616-378q29 15 46.5 43.5T680-272v112H40Zm720 0v-120q0-44-24.5-84.5T666-434q51 6 96 20.5t84 35.5q36 20 55 44.5t19 53.5v120H760ZM360-480q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47Zm400-160q0 66-47 113t-113 47q-11 0-28-2.5t-28-5.5q27-32 41.5-71t14.5-81q0-42-14.5-81T544-792q14-5 28-6.5t28-1.5q66 0 113 47t47 113ZM120-240h480v-32q0-11-5.5-20T580-306q-54-27-109-40.5T360-360q-56 0-111 13.5T140-306q-9 5-14.5 14t-5.5 20v32Zm240-320q33 0 56.5-23.5T440-640q0-33-23.5-56.5T360-720q-33 0-56.5 23.5T280-640q0 33 23.5 56.5T360-560Zm0 320Zm0-400Z" />
                            </svg>
                        </i>
                        <p class="nav-item-text">Help</p>
                    </a>
                </li>
            </ul>
        </div>
        <div class="container-3">
            <div>
                <a href="#logout" class="nav-link">
                    <i class="logout-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px">
                            <path d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h280v80H200v560h280v80H200Zm440-160-55-58 102-102H360v-80h327L585-622l55-58 200 200-200 200Z"/>
                        </svg>
                    </i>
                    <p>Logout</p>
                </a>
            </div>
            <a href="#access" class="nav-link">
                <i class="access-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px">
                        <path d="M480-28 346-160H160v-186L28-480l132-134v-186h186l134-132 134 132h186v186l132 134-132 134v186H614L480-28Zm0-252q83 0 141.5-58.5T680-480q0-83-58.5-141.5T480-680v400Zm0 140 100-100h140v-140l100-100-100-100v-140H580L480-820 380-720H240v140L140-480l100 100v140h140l100 100Zm0-340Z"/>
                    </svg>
                </i>
            </a>
        </div>
    </div>
    <main class="main-content">
        <header class="header">
            <div class="back-button">
                <h2 id="lesson-name">Lesson Details</h2>
            </div>
            <div class="user-settings">
                <div class="user-info">
                    <span>Name</span>
                    <a href="user-profile.html"><img src="res/user-icon.png" alt="User Icon"></a>
                </div>
                <div class="language-icon">
                    <a href="language-settings.html"><img src="res/language-icon.png" alt="Language Icon"></a>
                </div>
            </div>
        </header>
        <section class="content">
            <div class="lesson-description" id="lesson-description">
                <h2>Lesson Description</h2>
                <p>Dive into the world of algebra, where we transform abstract concepts into concrete solutions. This course covers the fundamentals of algebraic expressions, equations, inequalities, and functions. Students will learn to manipulate variables, solve linear and quadratic equations, and understand the properties of exponents and polynomials. Through real-world applications and problem-solving strategies, learners will develop critical thinking skills and a strong mathematical foundation, preparing them for advanced studies and everyday decision-making. Join us to unlock the power of algebra and enhance your analytical abilities!</p>
            </div>
            <div class="assignments">
                <div class="active-assignments">
                    <h2>Active Assignments For This Class</h2>
                    <div class="assignment-list">
                        <div class="assignment-item">
                            <span>13-A</span>
                            <span>Math Worksheet 1</span>
                            <span>12 May 23.59</span>
                            <button>See Details</button>
                        </div>
                    </div>
                </div>
                <div class="past-assignments">
                    <h2>Past Assignments For This Class</h2>
                    <div class="assignment-list">
                        <div class="assignment-item">
                            <span>12-A</span>
                            <span>Math Worksheet 1</span>
                            <span>12 May 23.59</span>
                            <button>See Details</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
</div>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const role = sessionStorage.getItem('role');
        const personId = sessionStorage.getItem('personId');
        const personName = sessionStorage.getItem('personName');
        const lessonName = new URLSearchParams(window.location.search).get('lessonName');
        const lessonDescription = new URLSearchParams(window.location.search).get('lessonDescription');
        const teacherName = new URLSearchParams(window.location.search).get('teacherName');
        const lessonId = new URLSearchParams(window.location.search).get('lessonId');
        const sidebar = document.querySelector('.side-bar');
        const welcomeMessage = document.querySelector('.user-info span');

        document.getElementById('lesson-name').textContent = lessonName + " taught by " + teacherName + ".";
        document.getElementById('lesson-description').textContent = lessonDescription;

        if (personName) {
            welcomeMessage.textContent = `Welcome, ${personName}!`;
        }

        sidebar.classList.remove('red', 'yellow', 'green');
        if (role === 'admin') {
            console.log('Setting sidebar color to green for admin');
            sidebar.classList.add('green');
        } else if (role === 'teacher') {
            console.log('Setting sidebar color to yellow for teacher');
            sidebar.classList.add('yellow');
        } else if (role === 'student') {
            console.log('Setting sidebar color to red for student');
            sidebar.classList.add('red');
        }

        function fetchHomeworkForLesson() {
            fetch(`fetchHomeworkForLesson?lessonId=${lessonId}&personId=${personId}&role=${role}`)
                .then(response => response.json())
                .then(homework => {
                    const activeAssignmentsContainer = document.querySelector('.active-assignments .assignment-list');
                    const pastAssignmentsContainer = document.querySelector('.past-assignments .assignment-list');

                    activeAssignmentsContainer.innerHTML = '';
                    pastAssignmentsContainer.innerHTML = '';

                    homework.forEach(hw => {
                        const dueDate = new Date(hw.due_date);
                        const currentDate = new Date();
                        const assignmentItem = document.createElement('div');
                        assignmentItem.classList.add('assignment-item');

                        const classSpan = document.createElement('span');
                        classSpan.textContent = hw.class_name;

                        const nameSpan = document.createElement('span');
                        nameSpan.textContent = hw.homework_name;

                        const dateSpan = document.createElement('span');
                        dateSpan.textContent = dueDate.toLocaleDateString();

                        const detailsButton = document.createElement('button');
                        detailsButton.textContent = 'See Details';
                        detailsButton.addEventListener('click', () => {
                            if (role === 'student') {
                                window.location.href = `assignment-details-student.html?id=${hw.homework_id}`;
                            } else if (role === 'teacher') {
                                window.location.href = `assignment-details-teacher.html?id=${hw.homework_id}`;
                            }
                        });

                        assignmentItem.appendChild(classSpan);
                        assignmentItem.appendChild(nameSpan);
                        assignmentItem.appendChild(dateSpan);
                        assignmentItem.appendChild(detailsButton);

                        if (dueDate >= currentDate) {
                            activeAssignmentsContainer.appendChild(assignmentItem);
                        } else {
                            pastAssignmentsContainer.appendChild(assignmentItem);
                        }
                    });
                })
                .catch(error => console.error('Error fetching homework for lesson:', error));
        }

        fetchHomeworkForLesson();
    });
</script>
</body>
</html>
